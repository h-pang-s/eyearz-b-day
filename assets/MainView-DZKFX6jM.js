import{f as T,c as se,r as ge,p as ve,v as pe,i as me,d as we,a as ye,b as ke,n as be,s as xe,o as Ee,e as ne,w as oe,m as R,g as v,u as p,h as ze,j as z,k as L,l as D,q as N,F as Le,t as Se,x as l,y as P,z as b,A as Te,B as He,C as We,D as q,E as m}from"./index-2YKmf4Ch.js";var Be=function(){};function re(e,s){let o;const t=()=>{const{currentTime:n}=s,i=(n===null?0:n.value)/100;o!==i&&e(i),o=i};return T.update(t,!0),()=>se(t)}const _=new WeakMap;let w;function Ie(e,s){if(s){const{inlineSize:o,blockSize:t}=s[0];return{width:o,height:t}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function Oe({target:e,contentRect:s,borderBoxSize:o}){var t;(t=_.get(e))===null||t===void 0||t.forEach(n=>{n({target:e,contentSize:s,get size(){return Ie(e,o)}})})}function Re(e){e.forEach(Oe)}function Pe(){typeof ResizeObserver>"u"||(w=new ResizeObserver(Re))}function _e(e,s){w||Pe();const o=ge(e);return o.forEach(t=>{let n=_.get(t);n||(n=new Set,_.set(t,n)),n.add(s),w==null||w.observe(t)}),()=>{o.forEach(t=>{const n=_.get(t);n==null||n.delete(s),n!=null&&n.size||w==null||w.unobserve(t)})}}const C=new Set;let H;function Ce(){H=()=>{const e={width:window.innerWidth,height:window.innerHeight},s={target:window,size:e,contentSize:e};C.forEach(o=>o(s))},window.addEventListener("resize",H)}function Ae(e){return C.add(e),H||Ce(),()=>{C.delete(e),!C.size&&H&&(H=void 0)}}function Me(e,s){return typeof e=="function"?Ae(e):_e(e,s)}const Ve=50,J=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),De=()=>({time:0,x:J(),y:J()}),Ne={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function K(e,s,o,t){const n=o[s],{length:r,position:i}=Ne[s],a=n.current,h=o.time;n.current=e[`scroll${i}`],n.scrollLength=e[`scroll${r}`]-e[`client${r}`],n.offset.length=0,n.offset[0]=0,n.offset[1]=n.scrollLength,n.progress=ve(0,n.scrollLength,n.current);const c=t-h;n.velocity=c>Ve?0:pe(n.current-a,c)}function Fe(e,s,o){K(e,"x",s,o),K(e,"y",s,o),s.time=o}function je(e,s){const o={x:0,y:0};let t=e;for(;t&&t!==s;)if(t instanceof HTMLElement)o.x+=t.offsetLeft,o.y+=t.offsetTop,t=t.offsetParent;else if(t.tagName==="svg"){const n=t.getBoundingClientRect();t=t.parentElement;const r=t.getBoundingClientRect();o.x+=n.left-r.left,o.y+=n.top-r.top}else if(t instanceof SVGGraphicsElement){const{x:n,y:r}=t.getBBox();o.x+=n,o.y+=r;let i=null,a=t.parentNode;for(;!i;)a.tagName==="svg"&&(i=a),a=t.parentNode;t=i}else break;return o}const $={start:0,center:.5,end:1};function Q(e,s,o=0){let t=0;if(e in $&&(e=$[e]),typeof e=="string"){const n=parseFloat(e);e.endsWith("px")?t=n:e.endsWith("%")?e=n/100:e.endsWith("vw")?t=n/100*document.documentElement.clientWidth:e.endsWith("vh")?t=n/100*document.documentElement.clientHeight:e=n}return typeof e=="number"&&(t=s*e),o+t}const $e=[0,0];function Ye(e,s,o,t){let n=Array.isArray(e)?e:$e,r=0,i=0;return typeof e=="number"?n=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?n=e.split(" "):n=[e,$[e]?e:"0"]),r=Q(n[0],o,t),i=Q(n[1],s),r-i}const Xe={All:[[0,0],[1,1]]},Ge={x:0,y:0};function Ue(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function qe(e,s,o){const{offset:t=Xe.All}=o,{target:n=e,axis:r="y"}=o,i=r==="y"?"height":"width",a=n!==e?je(n,e):Ge,h=n===e?{width:e.scrollWidth,height:e.scrollHeight}:Ue(n),c={width:e.clientWidth,height:e.clientHeight};s[r].offset.length=0;let u=!s[r].interpolate;const y=t.length;for(let d=0;d<y;d++){const W=Ye(t[d],c[i],h[i],a[r]);!u&&W!==s[r].interpolatorOffsets[d]&&(u=!0),s[r].offset[d]=W}u&&(s[r].interpolate=me(s[r].offset,we(t),{clamp:!1}),s[r].interpolatorOffsets=[...s[r].offset]),s[r].progress=ye(0,1,s[r].interpolate(s[r].current))}function Je(e,s=e,o){if(o.x.targetOffset=0,o.y.targetOffset=0,s!==e){let t=s;for(;t&&t!==e;)o.x.targetOffset+=t.offsetLeft,o.y.targetOffset+=t.offsetTop,t=t.offsetParent}o.x.targetLength=s===e?s.scrollWidth:s.clientWidth,o.y.targetLength=s===e?s.scrollHeight:s.clientHeight,o.x.containerLength=e.clientWidth,o.y.containerLength=e.clientHeight}function Ke(e,s,o,t={}){return{measure:()=>Je(e,t.target,o),update:n=>{Fe(e,o,n),(t.offset||t.target)&&qe(e,o,t)},notify:()=>s(o)}}const S=new WeakMap,Z=new WeakMap,F=new WeakMap,ee=e=>e===document.documentElement?window:e;function Y(e,{container:s=document.documentElement,...o}={}){let t=F.get(s);t||(t=new Set,F.set(s,t));const n=De(),r=Ke(s,e,n,o);if(t.add(r),!S.has(s)){const a=()=>{for(const d of t)d.measure()},h=()=>{for(const d of t)d.update(ke.timestamp)},c=()=>{for(const d of t)d.notify()},u=()=>{T.read(a,!1,!0),T.read(h,!1,!0),T.update(c,!1,!0)};S.set(s,u);const y=ee(s);window.addEventListener("resize",u,{passive:!0}),s!==document.documentElement&&Z.set(s,Me(s,u)),y.addEventListener("scroll",u,{passive:!0})}const i=S.get(s);return T.read(i,!1,!0),()=>{var a;se(i);const h=F.get(s);if(!h||(h.delete(r),h.size))return;const c=S.get(s);S.delete(s),c&&(ee(s).removeEventListener("scroll",c),(a=Z.get(s))===null||a===void 0||a(),window.removeEventListener("resize",c))}}function Qe({source:e,container:s,axis:o="y"}){e&&(s=e);const t={value:0},n=Y(r=>{t.value=r[o].progress*100},{container:s,axis:o});return{currentTime:t,cancel:n}}const j=new Map;function ae({source:e,container:s=document.documentElement,axis:o="y"}={}){e&&(s=e),j.has(s)||j.set(s,{});const t=j.get(s);return t[o]||(t[o]=xe()?new ScrollTimeline({source:s,axis:o}):Qe({source:s,axis:o})),t[o]}function Ze(e){return e.length===2}function ie(e){return e&&(e.target||e.offset)}function et(e,s){return Ze(e)||ie(s)?Y(o=>{e(o[s.axis].progress,o)},s):re(e,ae(s))}function tt(e,s){if(e.flatten(),ie(s))return e.pause(),Y(o=>{e.time=e.duration*o[s.axis].progress},s);{const o=ae(s);return e.attachTimeline?e.attachTimeline(o,t=>(t.pause(),re(n=>{t.time=t.duration*n},o))):be}}function st(e,{axis:s="y",...o}={}){const t={axis:s,...o};return typeof e=="function"?et(e,t):tt(e,t)}function nt(e,s,o){const t=e.on(s,o);return Ee(()=>{t()}),t}const ot=typeof window>"u";function te(e,s){Be(!!(!s||s.value))}function rt(){return{scrollX:R(0),scrollY:R(0),scrollXProgress:R(0),scrollYProgress:R(0)}}function at({container:e,target:s,...o}={}){const t=rt();return ne(()=>{te("target",s),te("container",e)}),oe([()=>e==null?void 0:e.value,()=>s==null?void 0:s.value,()=>o.offset],(n,r,i)=>{if(ot)return;const a=st((h,{x:c,y:u})=>{t.scrollX.set(c.current),t.scrollXProgress.set(c.progress),t.scrollY.set(u.current),t.scrollYProgress.set(u.progress)},{...o,container:(e==null?void 0:e.value)??void 0,target:(s==null?void 0:s.value)??void 0});i(()=>{a()})},{immediate:!0,flush:"post"}),t}const it={key:3,class:"fixed top-[8vh] left-[37.5vw]"},ct={__name:"MainView",emits:["stop-audio"],setup(e,{emit:s}){const o=s,t=window.innerWidth,n=window.innerHeight,r=[{backgroundImage:"url('../assets/images/p1.png')",right:"0vw",top:"0vh",rotate:"18deg",width:t>n?"30vw":"auto",height:t>n?"auto":"35vh",aspectRatio:1},{backgroundImage:"url('../assets/images/p2.png')",left:"40vw",top:"0vh",rotate:"-20deg",width:t>n?"18vw":"auto",height:t>n?"auto":"30vh",aspectRatio:1},{backgroundImage:"url('../assets/images/p3.png')",left:"-5vw",top:"20vh",rotate:"20deg",width:t>n?"20vw":"auto",height:t>n?"auto":"50vh",aspectRatio:1/2},{backgroundImage:"url('../assets/images/p4.png')",right:"5vw",bottom:"-5vh",rotate:"0deg",width:t>n?"18vw":"auto",height:t>n?"auto":"30vh",aspectRatio:1},{backgroundImage:"url('../assets/images/p5.png')",left:"0",top:"70vh",rotate:"0deg",width:t>n?"18vw":"auto",height:t>n?"auto":"30vh",aspectRatio:1},{backgroundImage:"url('../assets/images/p6.png')",left:"86vw",top:"65vh",rotate:"0deg",width:t>n?"20vw":"auto",height:t>n?"auto":"50vh",aspectRatio:1/2},{backgroundImage:"url('../assets/images/p7.png')",left:"20vw",bottom:"-15vh",rotate:"0deg",width:t>n?"25vw":"auto",height:t>n?"auto":"60vh",aspectRatio:1/1.5},{backgroundImage:"url('../assets/images/p8.png')",left:"55vw",bottom:"10vh",rotate:"0deg",width:t>n?"18vw":"auto",height:t>n?"auto":"30vh",aspectRatio:1},{backgroundImage:"url('../assets/images/p9.png')",right:"-5vw",top:"40vh",rotate:"0deg",width:t>n?"18vw":"auto",height:t>n?"auto":"22vh",aspectRatio:1},{backgroundImage:"url('../assets/images/p10.png')",left:"-3vw",top:"-4.8vh",rotate:"180deg",width:t>n?"18vw":"auto",height:t>n?"auto":"25vh",aspectRatio:1}],i=v(null),{scrollYProgress:a}=at({target:i,offset:["start start","end end"]}),h=p(a,[0,.4,1],["-50vw","30vw","20vw"]),c=p(a,[0,.4,1],["-50vw","30vw","20vw"]),u=p(a,[0,.1,.2,.3,.4],["-10deg","10deg","-10deg","10deg","0deg"]),y=p(a,[.5,.9],[t>n?"20vw":"auto",t>n?"15vw":"auto"]),d=p(a,[.5,.9],[t>n?"auto":"50vh",t>n?"auto":"30vh"]),W=p(a,[.5,.9],["30vh","10vh"]),le=p(a,[.5,.9],["30vh","10vh"]),ce=p(a,[0,.9,1],[0,0,1]),A=new Audio("../assets/audio/happy-birthday.mp3");A.volume=1,A.loop=!0;const X=v(!1),g=v(!1);nt(a,"change",f=>{f>=.99&&(X.value=!0)});const ue=()=>{const f=document.body.scrollHeight-window.innerHeight;let k=0;const O=f/600,V=setInterval(()=>{k+=O,window.scrollTo(0,k),k>=f&&clearInterval(V)},10)},x=v(!1),de=()=>{g.value||(g.value=!0,o("stop-audio"),setTimeout(()=>{A.play()},1e3),setTimeout(()=>{x.value=!0},1e4))},B=f=>{f.preventDefault()},E=v(!1),I=v(null),M=v(null),G=v(null),fe=async()=>{const f=M.value;E.value=!0,await q(async()=>{G.value=await I.value.getContext("2d"),G.value.drawImage(f,0,0,I.value.width,I.value.height)})},he=async()=>{E.value=!1,await q(()=>{U()})},U=()=>{navigator.mediaDevices.getUserMedia({video:!0}).then(f=>{M.value.srcObject=f}).catch(f=>{console.error("카메라 접근 실패:",f),alert("카메라 접근 실패.."),x.value=!1})};return oe(x,()=>{x.value&&U()}),ne(()=>{window.addEventListener("wheel",B,{passive:!1}),window.addEventListener("touchmove",B,{passive:!1}),ue()}),ze(()=>{window.removeEventListener("wheel",B),window.removeEventListener("touchmove",B)}),(f,k)=>(m(),z("div",{class:"w-full h-[300vh] bg-[#f14d4f]",ref_key:"containerRef",ref:i},[g.value?(m(),z(Le,{key:0},Se(r,(O,V)=>N(l(b).div,{key:V,class:"fixed w-[30vw] h-[50vh] text-white flex justify-center items-center aspect-1/2",style:P([{"background-repeat":"no-repeat","background-size":"contain"},O])},null,8,["style"])),64)):L("",!0),X.value?(m(),D(l(b).div,{key:1,onClick:de,class:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 h-[calc(15vw+15vh)] aspect-square",style:P({cursor:"pointer",backgroundImage:`url(${g.value?"../assets/images/cake.png":"../assets/images/box.png"})`,backgroundRepeat:"no-repeat",backgroundSize:"contain"}),initial:{opacity:0},animate:{opacity:l(ce)?1:0,rotate:g.value?0:[0,-5,0,5,0,-5,0,5,0]},transition:{rotate:{duration:2,repeat:g.value?null:1/0,ease:"linear"}}},null,8,["style","animate","transition"])):L("",!0),N(l(b).div,{class:"fixed w-[30vw] h-[50vh] text-white flex justify-center items-center aspect-1/2",style:P([{"background-image":"url('../assets/images/2.png')","background-repeat":"no-repeat","background-size":"contain"},{right:l(c),top:l(le),rotate:l(u),width:l(y),height:l(d)}])},null,8,["style"]),N(l(b).div,{class:"fixed w-[30vw] h-[50vh] text-white flex justify-center items-center aspect-1/2",style:P([{"background-image":"url('../assets/images/1.png')","background-repeat":"no-repeat","background-size":"contain"},{left:l(h),top:l(W),rotate:l(u),width:l(y),height:l(d)}])},null,8,["style"]),g.value?(m(),D(l(b).div,{key:2,class:"fixed top-[0] bottom-[0] left-[0] right-[0] flex justify-center items-center bg-[#d9d9d9]",initial:{opacity:1},animate:{opacity:[1,1,.9,.6,.3,0]},transition:{duration:5,times:[0,.5,.6,.7,.9,1]}},{default:Te(()=>[g.value?(m(),D(l(b).div,{key:0,class:"w-[80vw] h-[80vh]",style:{"background-image":"url('../assets/images/boom.png')","background-repeat":"no-repeat","background-size":"cover"}})):L("",!0)]),_:1})):L("",!0),x.value?(m(),z("div",it,[E.value?(m(),z("canvas",{key:1,ref_key:"canvasElement",ref:I,id:"canvas",class:"mt-4 border",style:{width:"25vw",height:"25vh"}},null,512)):(m(),z("video",{key:0,ref_key:"videoElement",ref:M,id:"video",autoplay:"",playsinline:"",class:"border",style:{width:"25vw",height:"25vh"}},null,512)),He("button",{onClick:k[0]||(k[0]=O=>E.value?he:fe)}," 📸 "+We(E.value?"다시찍기":"촬영하기"),1)])):L("",!0)],512))}};export{ct as default};
